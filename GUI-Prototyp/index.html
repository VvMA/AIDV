<!doctype html>
<html lang="us">
	<head>
		<meta charset="utf-16">
		<title>AIDV</title>
		<link href="css/flick/jquery-ui-1.10.4.custom.css" rel="stylesheet">
		<link href="css/jquery.DataTables.css" rel="stylesheet">
		<script src="js/jquery-1.10.2.js"></script>
		<script src="js/jquery-ui-1.10.4.custom.js"></script>
		<script src="js/jquery.dataTables.js"></script>
		
		<script>
			$(document).ready(function() {
			
				$("#bioModell").accordion({
					//event:false,
					heightStyle: "content"
				});
				$("#accordion_2").accordion({
					//event:false,
					header: "> div > h3",
					heightStyle: "content"
				});
				
				var t_bio = $("#example").DataTable({
					"fnRowCallback": function( nRow, aData, iDisplayIndex, iDisplayIndexFull ) {
						switch(aData[7]){
							case false:
								$(nRow).css('color', 'green')
								break;
							case true:
								$(nRow).css('color', 'red')
								break;
						}
					}
				});
				var t_anno = $("#t_anno").DataTable({
					"fnRowCallback": function( nRow, aData, iDisplayIndex, iDisplayIndexFull ) {
						switch(aData[5]){
							case false:
								$(nRow).css('color', 'green')
								break;
							case true:
								$(nRow).css('color', 'red')
								break;
						}
						// Einfügen einer Bilddatei in Spalte
						/**imgLink="jack.jpg";
						var imgTag = '<img src="' + imgLink + '"/>';
						$('td:eq(2)', nRow).html(imgTag);*/
					}
				});
				var counter = 1;
 
				$('#addRow').on( 'click', function () {
					var url="json/BIOMODEL.json";
					var word="";
					$.getJSON(url , function(model) {
						$.each(model.species, function(k,v) {
							$.each(this.annotations, function(m,n) {
								word+=" key: "+m+" value: "+n.url;
								t_bio.row.add( [
									v.id,
									v.name,
									n.url,
									n.label,
									n.definition,
									n.resource,
									n.exists,
									n.obsolete,
									n.consider
								] ).draw();
							})
							
							counter++;
						})
						window.alert(word);
					});
				} );
				$("#addRow_anno").on( 'click', function () {
					var url="json/annotation.json";
					var anno_url="", consider="";
					$.getJSON(url , function(anno) {
						$.each(anno.resource, function(k,v) {
							anno_url+="<br><a class='resource' href='"+v.url+"'>"+v.name+"</a></br>";
							anno_url+=" ";
						})
						if(anno.consider!=null){
							$.each(anno.consider, function(k,v) {
								consider+="<br><a class='resource' href='"+v.url+"'>"+v.name+"</a></br>";
							})
						} else {
							consider="Keine Alternativen verf&uumlgbar.";
						}
						t_anno.row.add( [
							anno.url,
							anno.label,
							anno.definition,
							anno_url,
							anno.exists,
							anno.obsolete,
							consider
						] ).draw();
					});
				} );
				
				$("#bioModell button").click(function(e) {
					e.preventDefault();
					if($(this).is('.do')){
						("#addRow").click();
					}
					var delta = ($(this).is('.next') ? 1 : -1);
					$('#bioModell').accordion('option', 'active', (
						$('#bioModell').accordion('option','active') + delta )
					);
					
					if(delta==1){
						var url="json/BIOMODEL.json";
						$.getJSON(url , function(data) {
							$("#model_id").html(data.id+": "+data.name);
						});
						//('#addRow').click();
					}
					
				});
				$("#accordion_2 button").click(function(e) {
					e.preventDefault();
					if($(this).is('.do')){
						("#addRow_anno").click();
					}
					var delta = ($(this).is('.next') ? 1 : -1);
					$('#accordion_2').accordion('option', 'active', (
						$('#accordion_2').accordion('option','active') + delta )
					);
					if(delta==1){
						var url="json/annotation.json";
						$.getJSON(url , function(data) {
							$("#anno_id").html("Label: "+data.label);
						});
						//('#addRow').click();
					}
				});
				
				$("#tabs").tabs();
				
				$("#start_button, #end_button, #search_button, #addRow, #addRow_anno, #addAnno").button();
				$("#start_button").click(function(){       
					$("div.biomodell").append("Ihre Suche nach: "+$("#search_bio").val()+" lieferte folgende Ergebnis.");
					$("#search_bio").val("");
				});
				$("#search_button").click(function(){       
					$("div.biomodell").append("Ihre Suche nach: "+$("#search_anno").val()+" lieferte folgende Ergebnis.");
					$("#search_anno").val("");
				});
				
				$('#addAnno').click( function() {
					var newDiv = "<div><h3>";
					var url="json/annotation.json";
					$.getJSON(url , function(data) {
						newDiv+=data.label;
						newDiv+="</h3><div><div><h3>Defintion:</h3>";
						newDiv+=data.definition;
						newDiv+="</div><div><h3>Resource:</h3>";
						if(data.resource!=null){
							$.each(data.resource, function(k,v) {
								newDiv+="<a class='resource' href='"+v.url+"'>"+v.name+"</a>";
								if(k<(data.resource.length-1)){
									newDiv+="<br></br>";
								}
							})
						} else {
							newDiv+="Keine Resourcen verf&uumlgbar.";
						}
						newDiv+="</div><div><h3>Obsolete:</h3>";
						newDiv+=data.obsolete;
						newDiv+="</div><div><h3>Exists:</h3>";
						newDiv+=data.exists;
						newDiv+="</div><div><h3>Consider:</h3>";
						if(data.consider!=null){
							$.each(data.consider, function(k,v) {
								newDiv+="<a class='resource' href='"+v.url+"'>"+v.name+"</a>";
								if(k<(data.consider.length-1)){
									newDiv+="<br></br>";
								}
							})
						} else {
							newDiv+="Keine Alternativen verf&uumlgbar.";
						}
						newDiv+="</div></div></div>";
						$('div.accordion_2').append(newDiv)
						$('div.accordion_2').accordion("refresh")
					});
				});
			});
		</script>
	</head>
	<body>
		<h1>AIDV</h1>
		<div id="tabs">
			<ul>
				<li><a href="#fragment-2">BioModell</a></li>
				<li><a href="#fragment-3">Annotation</a></li>
			</ul>
			<div id="fragment-2">
				<div id="bioModell">
					<h3><a href="#">Start</a></h3>
					<div>
						Bitte ein BioModell zum &Uumlberpr&uumlfen eingeben.
						<br></br>
						<div>
							<input id="search_bio" value="BIOMD0000000002"></input>
							<button id="start_button" class="next">Search</button>
						</div>
					</div>
					<h3><a href="#">Result</a></h3>
					<div>
						<div class="biomodell">
							Hallo, willkommen auf der Ergebnisseite. :)
							<br></br>
						</div>
						<h1 id="model_id"></h1>
						<table id="example" class="display" cellspacing="0" width="100%">
							<thead>
								<tr>
									<th>ID</th>
									<th>Name</th>
									<th>URL</th>
									<th>Label</th>
									<th>Definition</th>
									<th>Resource</th>
									<th>Exists</th>
									<th>Obsolete</th>
									<th>Consider</th>
								</tr>
							</thead>
							
						</table>
						<br></br>
						<button id="addRow" class="do">Do</button>
						<br></br>
						<button id="end_button" class="back">Ende</button>
					</div>
				</div>
			</div>
			<div id="fragment-3">
				<div id="accordion_2" class="accordion_2">
					<div>
						<h3><a href="#">Start</a></h3>
						<div>
							Bitte geben eine Annotation zum &Uumlberpr&uumlfen ein.
							<br></br>
							<div>
								<input id="search_anno" value="GO:0006915"></input>
								<button id="addAnno" class="next">Search</button>
							</div>
						</div>
					</div>
					<div>
						<h3><a href="#">Result</a></h3>
						<div>
							<div class="annotation">
								Hallo, willkommen auf der Ergebnisseite. :)
								<br></br>
							</div>
							<h1 id="anno_id"></h1>
							<table id="t_anno" class="display" cellspacing="0" width="100%">
								<thead>
									<tr>
										<th>URL</th>
										<th>Label</th>
										<th>Definition</th>
										<th>Resource</th>
										<th>Exists</th>
										<th>Obsolete</th>
										<th>Consider</th>
									</tr>
								</thead>
								
							</table>
							<br></br>
							<button id="addRow_anno" class="do">Do</button>
							<br></br>
							<button id="addAccordion">Add Accordion</button>
							<br></br>
							<button id="end_button" class="back">Ende</button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</body>
</html>
